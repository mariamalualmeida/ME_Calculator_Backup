<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miguelita - Assistente Financeira</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1976d2">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Miguelita">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=20250622160500">
    <link rel="stylesheet" href="chat.css?v=20250622160500">
</head>
<body data-theme="light" data-color-theme="teal">
    <div class="chat-container">
        <!-- Header do Chat -->
        <header class="chat-header">
            <button class="back-btn" onclick="voltarHub()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
                </svg>
            </button>
            
            <div class="chat-header-info">
                <h1 class="assistant-name">Miguelita</h1>
                <p class="assistant-subtitle">Assistente Financeira</p>
                <div class="status-indicator online" id="statusIndicator">
                    <span class="status-dot"></span>
                    <span class="status-text">Online</span>
                </div>
            </div>

            <div class="chat-header-actions">
                <button class="header-btn" onclick="abrirConfiguracoes()" title="Configurações de IA">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.97 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.04 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                    </svg>
                </button>
                
                <button class="header-btn" onclick="novaConversa()" title="Nova Conversa">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Área de Conversas -->
        <main class="chat-main">
            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <div class="assistant-avatar">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12,2A2,2 0 0,1 14,4C14,5.5 13,6.19 13,7.5V15.5A2,2 0 0,1 11,17.5H10.5V19.5A2,2 0 0,1 8.5,21.5H7.5A2,2 0 0,1 5.5,19.5V13.5A2,2 0 0,1 7.5,11.5H8V7.5C8,4.5 10,2 12,2M12,6A1.5,1.5 0 0,0 10.5,7.5V11.5H7.5V19.5H8.5V17.5H11A0.5,0.5 0 0,0 11.5,17V7.5A1.5,1.5 0 0,0 12,6Z"/>
                        </svg>
                    </div>
                    <div class="welcome-content">
                        <h3>Olá! Eu sou a Miguelita 👋</h3>
                        <p>Sua assistente financeira especializada da ME EMPREENDIMENTOS.</p>
                        <div class="welcome-options">
                            <p><strong>Posso ajudar você com:</strong></p>
                            <ul>
                                <li>📊 Análise de extratos bancários e faturas</li>
                                <li>💰 Consultoria financeira personalizada</li>
                                <li>📈 Avaliação de risco de crédito</li>
                                <li>🔢 Simulação de empréstimos</li>
                                <li>💡 Orientações financeiras gerais</li>
                            </ul>
                            <div class="quick-actions">
                                <button class="quick-btn" onclick="enviarComando('/simular')">🔢 Simular Empréstimo</button>
                                <button class="quick-btn" onclick="enviarComando('/analisar')">📊 Analisar Documentos</button>
                                <button class="quick-btn" onclick="enviarComando('/consultoria')">💡 Consultoria Financeira</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Loading indicator -->
            <div class="typing-indicator" id="typingIndicator" style="display: none;">
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <span class="typing-text">Miguelita está digitando...</span>
            </div>
        </main>

        <!-- Área de Input -->
        <footer class="chat-input-area">
            <div class="chat-input-container">
                <button class="attach-btn" onclick="abrirUpload()" title="Anexar arquivos">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"/>
                    </svg>
                </button>
                
                <div class="input-wrapper">
                    <textarea 
                        id="messageInput" 
                        placeholder="Digite sua mensagem ou use comandos como /simular, /analisar..."
                        rows="1"
                        maxlength="4000"
                    ></textarea>
                    <div class="char-counter">
                        <span id="charCount">0</span>/4000
                    </div>
                </div>
                
                <button class="send-btn" id="sendBtn" onclick="enviarMensagem()" disabled>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z"/>
                    </svg>
                </button>
            </div>
            
            <!-- Upload area oculta -->
            <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.csv,.jpg,.jpeg,.png" style="display: none;">
            
            <!-- Preview de arquivos -->
            <div class="file-preview" id="filePreview" style="display: none;"></div>
        </footer>
    </div>

    <!-- Modal de Configurações de IA -->
    <div class="modal-overlay" id="configModal" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3>Configurações de IA</h3>
                <button class="modal-close" onclick="fecharConfigModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="config-section">
                    <h4>Minhas Configurações</h4>
                    <div id="configsList"></div>
                    <button class="btn-secondary" onclick="adicionarNovaConfig()">+ Nova Configuração</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="chat.js?v=20250622160500"></script>
</body>
</html>